{"ast":null,"code":"var _jsxFileName = \"E:\\\\code\\\\newREACT\\\\tugi-react\\\\tugibus\\\\src\\\\pages\\\\BookTicket.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useContext, useEffect } from 'react';\nimport Apis, { endpoints } from \"../configs/Apis\";\nimport { useParams } from 'react-router-dom';\nimport { Card, Row, Col, Form, Button, Table, FormControl } from \"react-bootstrap\";\nimport seatimg from '../icon/account.svg';\nimport \"./BookTicket.css\";\nimport cookies from \"react-cookies\";\nimport { useSelector } from \"react-redux\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function BookTicket() {\n  _s();\n\n  const user = useSelector(state => state.user.user);\n  const {\n    tripId\n  } = useParams();\n  const {\n    lineId\n  } = useParams();\n  const [seatSelected, setSeatSelected] = useState(\"\");\n  const [tickets, setTickets] = useState(null);\n  const [trip, setTrip] = useState({});\n  const [line, setLine] = useState({});\n  const [spoint, setSpoint] = useState(\"\");\n  const [epoint, setEpoint] = useState(\"\");\n  const navigate = useNavigate();\n  const [ticketId, setTicketId] = useState();\n  const totalPrice = Number(trip.extra_changes) + Number(line.price);\n\n  const changeSeatSelected = id => {\n    setSeatSelected(id);\n  };\n\n  useEffect(() => {\n    const loadTicket = async () => {\n      try {\n        let res = await Apis.get(endpoints['tickets'](tripId));\n        setTickets(res.data);\n      } catch (err) {\n        console.error(err);\n      }\n    };\n\n    const loadTrip = async () => {\n      try {\n        let res = await Apis.get(`${endpoints['trips']}${tripId}/`);\n        setTrip(res.data);\n      } catch (err) {\n        console.error(err);\n      }\n    };\n\n    const loadLine = async () => {\n      try {\n        let res = await Apis.get(endpoints['line'](lineId));\n        setLine(res.data);\n        setSpoint(res.data.start_point);\n        setEpoint(res.data.end_point);\n      } catch (err) {\n        console.error(err);\n      }\n    };\n\n    loadLine();\n    loadTrip();\n    loadTicket();\n    localStorage.setItem(\"tripId\", tripId);\n    localStorage.setItem(\"lineId\", lineId);\n  }, []); // console.log(tickets)\n\n  const bookTicket = event => {\n    event.preventDefault();\n\n    let bookSeatTicket = async () => {\n      const formData = new FormData();\n      formData.append(\"seat_position\", seatSelected);\n      let res = await Apis.post(endpoints['book-ticket'](tripId), formData, {\n        headers: {\n          'Authorization': `Bearer ${cookies.load(\"access_token\")}`\n        }\n      });\n      console.log(res.data.id);\n      setTicketId(res.data.id);\n    };\n\n    bookSeatTicket();\n    console.log(ticketId); // navigate(`/payment/${ticketId}`)\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: tickets == null ? /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        minHeight: \"55vh\"\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        role: \"alert\",\n        className: \"fade alert alert-danger show\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Ch\\u01B0a c\\xF3 v\\xE9\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Y\\xEAu c\\u1EA7u ch\\u1ECDn tuy\\u1EBFn v\\xE0 chuy\\u1EBFn xe\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        minHeight: \"55vh\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        className: \"title-page\",\n        children: \" \\u0110\\u1EB7t v\\xE9 xe \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Row, {\n        style: {\n          maxWidth: \"900px\",\n          margin: \" auto\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(Col, {\n          sm: 4,\n          className: \"book-ticket-col\",\n          style: {\n            minWidth: \"300px\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"book-ticket-text red\",\n            children: [\" \", line.name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"book-ticket-text\",\n            children: [\" Kh\\u1EDFi h\\xE0nh : \", spoint.address]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 103,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"book-ticket-text\",\n            children: [\" \\u0110i\\u1EC3m \\u0111\\u1EBFn : \", epoint.address]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"book-ticket-text\",\n            children: [\"S\\u1ED1 gh\\u1EBF : \", seatSelected]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"book-ticket-text\",\n            children: \"T\\u1ED5ng ti\\u1EC1n v\\xE9\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"book-ticket-text red\",\n            children: totalPrice\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            alt: \"d\",\n            className: \"bus-img\",\n            src: \"/images/xe-nha-1.png\",\n            style: {\n              width: \"240px\",\n              marginTop: \"15px\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          md: \"auto\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Col, {\n          sm: 7,\n          className: \"book-ticket-col\",\n          style: {\n            minWidth: \"525px\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"book-ticket-text red\",\n            children: \"S\\u01A1 \\u0111\\u1ED3 gh\\u1EBF\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 112,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Row, {\n            style: {\n              padding: \"36px\",\n              overflowY: \"scroll\",\n              maxHeight: \"75vh\"\n            },\n            children: Object.keys(tickets).map(i => /*#__PURE__*/_jsxDEV(Col, {\n              md: 3,\n              xs: 12,\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: tickets[i] === \"blank\" ? 'empty-seat' : 'booked-seat',\n                onClick: () => {\n                  changeSeatSelected(i);\n                },\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  style: {\n                    width: \"70px\"\n                  },\n                  src: seatimg\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 117,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  style: {\n                    margin: \"0\"\n                  },\n                  children: i\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 118,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 116,\n                columnNumber: 41\n              }, this)\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 115,\n              columnNumber: 37\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: seatSelected === \"\" ? \"book-form-hide\" : \"book-ticket-col\",\n        style: {\n          maxWidth: \"750px\",\n          margin: \"3em auto\",\n          textAlign: \"left\"\n        },\n        children: user == null ? /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: \"center\"\n          },\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"book-ticket-text red\",\n            children: \"\\u0110\\u0103ng nh\\u1EADp \\u0111\\u1EC3 \\u0111\\u1EB7t v\\xE9\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 29\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              textAlign: \"center\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"book-ticket-text red\",\n              children: \"Th\\xF4ng tin v\\xE9\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 134,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(Form, {\n            children: [/*#__PURE__*/_jsxDEV(Form.Group, {\n              className: \"mb-3\",\n              controlId: \"formTripName\",\n              children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                children: \"Chuy\\u1EBFn\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 139,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                type: \"text\",\n                readOnly: \"readOnly\",\n                value: trip.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 140,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n              className: \"mb-3\",\n              controlId: \"formTripPrice\",\n              children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                children: \"Ti\\u1EC1n v\\xE9\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 143,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                type: \"text\",\n                readOnly: \"readOnly\",\n                value: totalPrice\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 144,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n              className: \"mb-3\",\n              controlId: \"formTripSeat\",\n              children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                children: \"V\\u1ECB tr\\xED gh\\u1EBF\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 147,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                type: \"text\",\n                readOnly: \"readOnly\",\n                value: seatSelected\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 146,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n              className: \"mb-3\",\n              controlId: \"formUserName\",\n              children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                children: \"H\\u1ECD v\\xE0 t\\xEAn\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                type: \"text\",\n                readOnly: \"readOnly\",\n                value: user.first_name + \" \" + user.last_name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(Form.Group, {\n              className: \"mb-3\",\n              controlId: \"formUserPhone\",\n              children: [/*#__PURE__*/_jsxDEV(Form.Label, {\n                children: \"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 155,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(Form.Control, {\n                type: \"text\",\n                readOnly: \"readOnly\",\n                value: user.number_phone\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 156,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 154,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"d-grid gap-2\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-secondary btn-lg\",\n                style: {\n                  background: \"linear-gradient(90deg, rgb(119, 199, 253) 0%, rgb(26, 23, 23) 100%)\"\n                },\n                variant: \"secondary\",\n                size: \"lg\",\n                onClick: bookTicket,\n                children: \"\\u0110\\u1EB7t v\\xE9\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 159,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 158,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 17\n    }, this)\n  }, void 0, false);\n}\n\n_s(BookTicket, \"FwljRTERwDqz7fVLYOSK1pYGH6k=\", false, function () {\n  return [useSelector, useParams, useParams, useNavigate];\n});\n\n_c = BookTicket;\n\nvar _c;\n\n$RefreshReg$(_c, \"BookTicket\");","map":{"version":3,"sources":["E:/code/newREACT/tugi-react/tugibus/src/pages/BookTicket.js"],"names":["React","useState","useContext","useEffect","Apis","endpoints","useParams","Card","Row","Col","Form","Button","Table","FormControl","seatimg","cookies","useSelector","useNavigate","BookTicket","user","state","tripId","lineId","seatSelected","setSeatSelected","tickets","setTickets","trip","setTrip","line","setLine","spoint","setSpoint","epoint","setEpoint","navigate","ticketId","setTicketId","totalPrice","Number","extra_changes","price","changeSeatSelected","id","loadTicket","res","get","data","err","console","error","loadTrip","loadLine","start_point","end_point","localStorage","setItem","bookTicket","event","preventDefault","bookSeatTicket","formData","FormData","append","post","headers","load","log","minHeight","maxWidth","margin","minWidth","name","address","width","marginTop","padding","overflowY","maxHeight","Object","keys","map","i","textAlign","first_name","last_name","number_phone","background"],"mappings":"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","sourcesContent":["import React, { useState , useContext, useEffect} from 'react'\r\nimport Apis, { endpoints } from \"../configs/Apis\";\r\nimport { useParams } from 'react-router-dom'\r\nimport {Card, Row, Col, Form,Button,Table, FormControl} from \"react-bootstrap\";\r\nimport seatimg from '../icon/account.svg'\r\nimport \"./BookTicket.css\"\r\nimport cookies from \"react-cookies\";\r\nimport { useSelector } from \"react-redux\"\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\n\r\nexport default function BookTicket(){\r\n\r\n    const user = useSelector(state => state.user.user)\r\n    const {tripId} = useParams()\r\n    const {lineId} = useParams()\r\n    const[seatSelected, setSeatSelected] = useState(\"\")\r\n    const[tickets, setTickets] = useState(null)\r\n    const[trip, setTrip] = useState({})\r\n    const[line, setLine] = useState({})\r\n    const[spoint, setSpoint] = useState(\"\")\r\n    const[epoint, setEpoint] = useState(\"\")\r\n    const navigate = useNavigate();\r\n    const[ticketId, setTicketId] = useState()\r\n    \r\n    const totalPrice = Number(trip.extra_changes) + Number(line.price)\r\n\r\n    const changeSeatSelected=(id)=>{\r\n        setSeatSelected(id)\r\n    }\r\n    useEffect(() => {\r\n        const loadTicket = async ()=>{\r\n            try{\r\n                let res = await Apis.get(endpoints['tickets'](tripId))\r\n                setTickets(res.data)\r\n            }catch(err){\r\n                console.error(err)\r\n            }\r\n        }\r\n        const loadTrip = async ()=>{\r\n            try{\r\n                let res = await Apis.get(`${endpoints['trips']}${tripId}/`)\r\n                setTrip(res.data)\r\n            }catch(err){\r\n                console.error(err)\r\n            }\r\n        }\r\n        const loadLine = async ()=>{\r\n            try{\r\n                let res = await Apis.get(endpoints['line'](lineId))\r\n                setLine(res.data)  \r\n                setSpoint(res.data.start_point) \r\n                setEpoint(res.data.end_point) \r\n            }catch(err){\r\n                console.error(err)\r\n            }\r\n        }\r\n        loadLine()\r\n        loadTrip() \r\n        loadTicket() \r\n        localStorage.setItem(\"tripId\",tripId)\r\n        localStorage.setItem(\"lineId\",lineId)\r\n    },[])\r\n\r\n    // console.log(tickets)\r\n    \r\n    const bookTicket = (event) =>{\r\n        event.preventDefault()\r\n        \r\n        let bookSeatTicket = async() =>{\r\n            const formData = new FormData()\r\n            formData.append(\"seat_position\", seatSelected)\r\n            \r\n            let res = await Apis.post(endpoints['book-ticket'](tripId),formData,{\r\n                headers: {\r\n                    'Authorization': `Bearer ${cookies.load(\"access_token\")}`\r\n                }\r\n                })\r\n            console.log(res.data.id)\r\n            setTicketId(res.data.id)\r\n        }\r\n        bookSeatTicket()\r\n        console.log(ticketId)\r\n        // navigate(`/payment/${ticketId}`)\r\n    }\r\n    \r\n    return(\r\n        <>  \r\n            {tickets == null?(\r\n                <div style={{minHeight:\"55vh\"}}>\r\n                    <div role=\"alert\" className='fade alert alert-danger show'>\r\n                        <h1>Chưa có vé</h1>\r\n                        <p>Yêu cầu chọn tuyến và chuyến xe</p>\r\n                    </div>\r\n                    \r\n                </div>\r\n            ):(\r\n                <div style={{minHeight:\"55vh\"}}>\r\n                    <h1 className=\"title-page\"> Đặt vé xe </h1>\r\n                    <Row style={{maxWidth: \"900px\", margin: \" auto\"}}>\r\n                        <Col sm={4} className=\"book-ticket-col\" style={{minWidth:\"300px\"}}>\r\n                            <p className=\"book-ticket-text red\"> {line.name}</p>\r\n                            <p className=\"book-ticket-text\"> Khởi hành : {spoint.address}</p>\r\n                            <p className=\"book-ticket-text\" > Điểm đến : {epoint.address}</p>\r\n                            <p className=\"book-ticket-text\" >Số ghế : {seatSelected}</p>\r\n                            <p className=\"book-ticket-text\" >Tổng tiền vé</p>\r\n                            <p className=\"book-ticket-text red\">{totalPrice}</p>\r\n                            <img alt=\"d\" className=\"bus-img\" src=\"/images/xe-nha-1.png\"  style={{width:\"240px\", marginTop:\"15px\"}}/>\r\n                        </Col>\r\n                        <Col md=\"auto\"></Col>\r\n                        <Col sm={7} className=\"book-ticket-col\" style={{minWidth:\"525px\"}}>\r\n                            <p className=\"book-ticket-text red\">Sơ đồ ghế</p>\r\n                            <Row style={{padding:\"36px\", overflowY:\"scroll\", maxHeight:\"75vh\"}}>\r\n                                {Object.keys(tickets).map(i => \r\n                                    <Col key={i} md={3} xs={12}>\r\n                                        <button className={tickets[i] === \"blank\" ? 'empty-seat' : 'booked-seat'} onClick={() => { changeSeatSelected(i) }}>\r\n                                            <img style={{width:\"70px\"}} src={seatimg} />\r\n                                            <p style={{margin:\"0\"}}>{i}</p>\r\n                                        </button>\r\n                                    </Col>\r\n                                    )}\r\n                            </Row>\r\n                        </Col>\r\n                    </Row>\r\n                    <div className={seatSelected ===\"\" ? \"book-form-hide\":\"book-ticket-col\"} style={{maxWidth: \"750px\", margin:\"3em auto\", textAlign:\"left\"}}>\r\n                         \r\n                        {user == null?(\r\n                            <div style={{textAlign:\"center\"}}>\r\n                                <p className=\"book-ticket-text red\">Đăng nhập để đặt vé</p>\r\n                            </div>\r\n                        ):(\r\n                            <>\r\n                                <div style={{textAlign:\"center\"}}>\r\n                                    <p className=\"book-ticket-text red\">Thông tin vé</p>\r\n                                </div>\r\n                                \r\n                                <Form>\r\n                                    <Form.Group className=\"mb-3\" controlId=\"formTripName\">\r\n                                        <Form.Label>Chuyến</Form.Label>\r\n                                        <Form.Control type=\"text\" readOnly=\"readOnly\" value={trip.name}/>\r\n                                    </Form.Group>\r\n                                    <Form.Group className=\"mb-3\" controlId=\"formTripPrice\">\r\n                                        <Form.Label>Tiền vé</Form.Label>\r\n                                        <Form.Control type=\"text\" readOnly=\"readOnly\" value={totalPrice}/>\r\n                                    </Form.Group>\r\n                                    <Form.Group className=\"mb-3\" controlId=\"formTripSeat\">\r\n                                        <Form.Label>Vị trí ghế</Form.Label>\r\n                                        <Form.Control type=\"text\" readOnly=\"readOnly\" value={seatSelected}/>\r\n                                    </Form.Group>\r\n                                    <Form.Group className=\"mb-3\" controlId=\"formUserName\">\r\n                                        <Form.Label>Họ và tên</Form.Label>\r\n                                        <Form.Control type=\"text\" readOnly=\"readOnly\" value={user.first_name +\" \"+ user.last_name}/>\r\n                                    </Form.Group>\r\n                                    <Form.Group className=\"mb-3\" controlId=\"formUserPhone\">\r\n                                        <Form.Label>Số điện thoại</Form.Label>\r\n                                        <Form.Control type=\"text\" readOnly=\"readOnly\" value={user.number_phone}/>\r\n                                    </Form.Group>\r\n                                    <div className=\"d-grid gap-2\">\r\n                                        <button \r\n                                        className=\"btn btn-secondary btn-lg\" \r\n                                        style={{background:\"linear-gradient(90deg, rgb(119, 199, 253) 0%, rgb(26, 23, 23) 100%)\"}} \r\n                                        variant=\"secondary\" \r\n                                        size=\"lg\"\r\n                                        onClick={bookTicket}\r\n                                        >\r\n                                            Đặt vé\r\n                                        </button>\r\n                                    </div>\r\n                                </Form>\r\n                            </>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n            )\r\n            }\r\n        </>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}